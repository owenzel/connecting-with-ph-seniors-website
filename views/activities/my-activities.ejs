<%- include ("./../partials/add_btn"); %>
<%- include ("./../partials/messages"); %>

<div class="container">
    <h1>My Activities</h1>
    <p>Welcome, <%= user.name %>! View upcoming activities <a href="/">HERE</a>.</p>
    <br>

    <% if (activitiesCreated.length > 0) { %>
        <p>Here are the activities that you created:</p>
        <table class="striped">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Leader Name</th>
                    <th>RSVPs</th>
                    <th><!--Edit and delete buttons--></th>
                </tr>
            </thead>
            <tbody>
                <% activitiesCreated.forEach(function(activity) { %>
                    <tr>
                        <td><a href="/activities/<%= activity._id %>"><%= activity.title %></a></td>
                        <td><%= formatDate(activity.date, 'MMMM Do YYYY, h:mm a') %></td>
                        <td><span class="dash-status"><%= activity.status %></span></td>
                        <td><%= activity.leaderName %></td>
                        <td>
                            <a href="/activities/:id/rsvps">Click here to see the <%= activity.rsvps.length %> RSVP(s).</a>
                        </td>
                        <td>
                            <a href="/activities/edit/<%= activity._id %>" class="btn btn-float">
                                <i class="fas fa-edit"></i>
                            </a>

                            <form action="/activities/<%= activity._id %>" method="POST" id="delete-form">
                                <input type="hidden" name="_method" value="DELETE">
                                <button type="submit" class="btn red">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    
    <% } else { %>
        <p>You have not created any activities yet.</p>

    <% } if (activitiesLeading.length > 0) { %>
        <p>Here are the activities that you are leading:</p>
        <table class="striped">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Leader Name</th>
                    <th>RSVPs</th>
                </tr>
            </thead>
            <tbody>
                <% activitiesLeading.forEach(function(activity) { %>
                    <tr>
                        <td><a href="/activities/<%= activity._id %>"><%= activity.title %></a></td>
                        <td><%= formatDate(activity.date, 'MMMM Do YYYY, h:mm a') %></td>
                        <td><span class="dash-status"><%= activity.status %></span></td>
                        <td><%= activity.leaderName %></td>
                        <td>
                            <a href="/activities/:<%= activity._id %>/rsvps">Click here to see the <%= activity.rsvps.length %> RSVP(s).</a>
                        </td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    
    <% } else { %>
        <p>You are not leading any activities yet.</p>
    
    <% } if (activitiesAttending.length > 0) { %>
        <p>Here are the activities that you are attending:</p>
        <table class="striped">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Leader Name</th>
                    <th><!--Edit and delete buttons--></th>
                </tr>
            </thead>
            <tbody>
                <% activitiesAttending.forEach(function(activity) { %>
                    <tr>
                        <td><a href="/activities/<%= activity._id %>"><%= activity.title %></a></td>
                        <td><%= formatDate(activity.date, 'MMMM Do YYYY, h:mm a') %></td>
                        <td><span class="dash-status"><%= activity.status %></span></td>
                        <td><%= activity.leaderName %></td>
                        <td>
                            <a href="/activities/:<%= activity._id %>/cancel">CANCEL RSVP</a>
                        </td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    
    <% } else { %>
        <p>You are not signed up for any activities yet.</p>
    <% } %>
    <br>
</div>